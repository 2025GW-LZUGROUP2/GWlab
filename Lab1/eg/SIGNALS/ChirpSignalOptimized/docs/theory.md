# 调频信号理论基础

## 1. 调频信号概述

调频信号（Chirp Signal）是一种频率随时间变化的信号，广泛应用于雷达、声纳、扩频通信、医学超声成像等领域。根据频率变化的函数关系，调频信号可以分为线性调频、二次调频、指数调频等多种类型。

### 调频信号的一般形式

调频信号的标准数学表达式为：

$$s(t) = A\cos[\phi(t)]$$

其中：
- $A$ 是信号幅度（本例中为常数）
- $\phi(t)$ 是随时间变化的相位函数

## 2. 二次调频信号的数学表示

### 相位函数

本项目中的二次调频信号，其相位函数是时间的三次多项式：

$$\phi(t) = a_1t + a_2t^2 + a_3t^3$$

其中 $a_1$、$a_2$ 和 $a_3$ 是决定相位变化特性的参数。

### 瞬时频率

瞬时频率定义为相位函数对时间的导数除以 $2\pi$：

$$f_i(t) = \frac{1}{2\pi}\frac{d\phi(t)}{dt} = \frac{1}{2\pi}(a_1 + 2a_2t + 3a_3t^2)$$

这表明二次调频信号的瞬时频率是时间的二次函数，这也是"二次调频"名称的由来。瞬时频率反映了信号在某一时刻的振荡速率。

### 最大瞬时频率

对于时间范围为$[0,1]$秒的信号，且参数$a_1,a_2,a_3$均为正值，瞬时频率单调增加，因此最大瞬时频率出现在$t=1$时：

$$f_{max} = \frac{1}{2\pi}(a_1 + 2a_2 \cdot 1 + 3a_3 \cdot 1^2) = \frac{1}{2\pi}(a_1 + 2a_2 + 3a_3)$$

在代码实现中，通常省略$2\pi$系数，直接计算：$maxFreq = a_1 + 2a_2 + 3a_3$

### 相位参数的物理意义

- $a_1$：初始角频率，代表 $t=0$ 时的角速度（弧度/秒）
- $a_2$：角频率的线性变化率（弧度/秒²）
- $a_3$：角频率的二次变化率（弧度/秒³）

转换为循环频率（Hz）时，需除以$2\pi$：
- 初始频率：$f_0 = \frac{a_1}{2\pi}$ Hz
- 终止频率（$t=1$时）：$f_1 = \frac{a_1 + 2a_2 + 3a_3}{2\pi}$ Hz

## 3. 采样理论与频谱分析

### 带宽与Nyquist频率

对于二次调频信号，其带宽$f_B$近似等于最大瞬时频率与最小瞬时频率之差：

$$f_B \approx f_{max} - f_{min} = \frac{1}{2\pi}(2a_2 + 3a_3)$$

若信号从$t=0$开始，则$f_{min} = \frac{a_1}{2\pi}$，带宽为：

$$f_B \approx \frac{1}{2\pi}(2a_2 + 3a_3)$$

根据Nyquist采样定理，采样频率$f_s$必须满足：

$$f_s \geq 2f_B$$

这个临界采样频率$2f_B$被称为Nyquist频率（第一种定义）。

### 离散傅里叶变换（DFT）与频谱

对于长度为$N$的离散信号$\{x[n]\}_{n=0}^{N-1}$，其DFT定义为：

$$X[k] = \sum_{n=0}^{N-1} x[n] e^{-j2\pi nk/N}, \quad k = 0,1,...,N-1$$

对应的频率为：

$$f_k = \frac{k}{N} f_s, \quad k = 0,1,...,N-1$$

其中：
- 当$k \in [0, N/2]$时，$f_k$表示正频率
- 当$k \in [N/2+1, N-1]$时，$f_k$对应负频率，实际值为$f_k - f_s$

### FFT结果的排列与对称性

对于实值信号，其FFT结果具有共轭对称性：

$$X[N-k] = X^*[k]$$

这意味着FFT结果的后半部分（对应负频率）与前半部分（对应正频率）包含相同的信息，因此在分析中通常只保留前半部分。

FFT结果的原始排列为：
```
[X[0], X[1], ..., X[N/2], X[N/2+1], ..., X[N-1]]
```

对应的频率为：
```
[0, Δf, ..., fs/2, -fs/2+Δf, ..., -Δf]
```

其中$\Delta f = \frac{f_s}{N}$是频率分辨率。

使用`fftshift`函数可将零频分量移至中心：
```
[X[N/2+1], ..., X[N-1], X[0], X[1], ..., X[N/2]]
```

对应频率：
```
[-fs/2+Δf, ..., -Δf, 0, Δf, ..., fs/2]
```

## 4. 时频分析

### 短时傅里叶变换（STFT）

STFT通过在不同时间点应用加窗的傅里叶变换，实现信号的时频分析：

$$\text{STFT}(t,f) = \int_{-\infty}^{\infty} s(\tau)w(\tau-t)e^{-j2\pi f\tau}d\tau$$

其中$w(t)$是窗函数。STFT的平方幅值称为频谱图（Spectrogram）：

$$\text{Spectrogram}(t,f) = |\text{STFT}(t,f)|^2$$

### 离散STFT实现

在MATLAB中，STFT通过`spectrogram`函数实现，其参数包括：
- 窗口长度（winLen）：每次分析的时间段长度
- 重叠长度（ovrlp）：相邻窗口之间共享的时间长度
- 采样频率（fs）：用于将时间和频率转换为物理单位

离散STFT的数学表达式为：

$$\text{STFT}[m, k] = \sum_{n=0}^{N-1} x[n] w[n-mH] e^{-j2\pi nk/N}$$

其中：
- $m$是时间框架索引
- $k$是频率箱索引
- $H$是跳跃长度（窗口长度减去重叠长度）
- $N$是FFT长度
- $w[n]$是窗函数

### 时频分辨率权衡

时频分析中存在基本的不确定性原理，体现为时间分辨率和频率分辨率之间的权衡：

- 窗口长度增加：提高频率分辨率，但降低时间分辨率
- 窗口长度减少：提高时间分辨率，但降低频率分辨率

对于二次调频信号，其频率随时间快速变化，因此需要选择合适的窗口长度以平衡这种权衡。

## 5. 调频信号的应用

### 雷达系统

调频连续波（FMCW）雷达使用调频信号测量距离和速度：

$$R = \frac{c \cdot \Delta f}{2 \cdot \frac{df}{dt}}$$

其中：
- $R$是目标距离
- $c$是光速
- $\Delta f$是发射和接收信号之间的频率差
- $\frac{df}{dt}$是频率扫描率

### 其他应用领域

- 声纳系统：水下目标探测和海底测绘
- 生物医学成像：医学超声成像提高分辨率
- 扩频通信：提高抗干扰能力和频谱利用效率

## 参考文献

1. S. Kay, "Fundamentals of Statistical Signal Processing: Detection Theory", Prentice Hall, 1998.
2. L. Cohen, "Time-Frequency Analysis", Prentice Hall, 1995.
3. A. V. Oppenheim and R. W. Schafer, "Discrete-Time Signal Processing", Pearson, 2014.
4. F. Hlawatsch and G. F. Boudreaux-Bartels, "Linear and quadratic time-frequency signal representations," IEEE Signal Processing Magazine, vol. 9, no. 2, pp. 21-67, 1992.
