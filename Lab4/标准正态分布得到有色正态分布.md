



## 1. 设定与目标

给定标准二元正态向量（列向量约定）  
$X \sim \mathcal N(\mu_X, I_2)$，其中常见的标准情形是 $\mu_X=\begin{bmatrix}0\\ \dots   \\0\end{bmatrix}$、$\operatorname{Cov}(X)=I_2$。  
希望构造
$$
Y \sim \mathcal N(\mu_Y,\ \Sigma),
$$
其中 $\Sigma\in\mathbb R^{2\times 2}$ 对称正定。

## 2. 线性（仿射）变换保持正态性

若 $X$ 是多元正态，任取矩阵 $A$ 与向量 $b$，则 $Y=b+AX$ 仍为正态（可由特征函数或“一切线性组合仍为正态”性质推出）。

## 3. 协方差的变换公式

对任意随机向量 $X$ 与常矩阵 $A$：
$$
\operatorname{Cov}(AX) \;=\; A\,\operatorname{Cov}(X)\,A^\top.
$$
证明：
$$
\begin{aligned}
\operatorname{Cov}(AX)
&= \mathbb E\!\big[(AX-\mathbb E[AX])(AX-\mathbb E[AX])^\top\big] \\\\
&= \mathbb E\!\big[A(X-\mathbb E[X])(X-\mathbb E[X])^\top A^\top\big] \\\\
&= A\,\operatorname{Cov}(X)\,A^\top.
\end{aligned}
$$

## 4. 用 Cholesky 选对的线性变换

因为 $\Sigma$ **对称正定**，可做 Cholesky 分解：
$$
\Sigma = L\,L^\top \quad(\text{$L$ 下三角，对角元 } > 0).
$$
于是只要取
$$
Y = \mu_Y + L\,X,
$$
就有
$$
\operatorname{Cov}(Y) = L\,\operatorname{Cov}(X)\,L^\top
= L\,I\,L^\top
= \Sigma.
$$

另一种常见写法是上三角因子 $R$，$\Sigma=R^\top R$。若用**行向量/样本矩阵**记法，设 $Y=\mu_Y + X R$，同理
$\operatorname{Cov}(Y)=R^\top R=\Sigma$。

> 要点：找 $A$ 使 $A A^\top=\Sigma$ 即可；Cholesky 正好提供这样的 $A$。

## 5. 均值如何控制

常向量只会平移均值、不改变协方差：
$$
Y=\mu_Y + A X \quad\Rightarrow\quad \mathbb E[Y]=\mu_Y,\ \ \operatorname{Cov}(Y)=A A^\top.
$$

## 6. 实操（MATLAB）

```{matlab}
% 随机种子
rng(42);

% 目标均值 & 协方差（可自行修改）
mu = [1.0; -0.5];
Sigma = [1.5 0.9; 0.9 1.0];   % 对称正定

% Cholesky：MATLAB 的 chol 返回上三角 R，使得 Sigma = R' * R
R = chol(Sigma, 'upper');

% 从标准正态采样（行向量样本；每行一个样本）
n = 5000;
X = randn(n, 2);

% 线性变换：Y = mu' + X * R
Y = X * R + mu';

% 样本协方差与目标对比
sampleCov = cov(Y, 1);   % 以总体无偏/有偏均可，这里用有偏(除以 n)
diff = sampleCov - Sigma;
froNorm = norm(diff, 'fro');

disp('目标 Σ ='); disp(Sigma);
disp('Cholesky 上三角 R （Σ = R^T R） ='); disp(R);
disp('样本协方差 ='); disp(sampleCov);
disp(['‖sampleCov − Σ‖_F = ', num2str(froNorm)]);
```
output:
```
>> teset
目标 Σ =
    1.5000    0.9000
    0.9000    1.0000

Cholesky 上三角 R （Σ = R^T R） =
    1.2247    0.7348
         0    0.6782

样本协方差 =
    1.5198    0.9106
    0.9106    1.0081

‖sampleCov − Σ‖_F = 0.026133
```